# ๐ค AI Travel Assistant (Enterprise Edition)

ูุธุงู ูุณุงุนุฏ ุฐูู ูููุคุณุณุงุชุ ูุตูู ููุฅุฌุงุจุฉ ุนูู ุงุณุชูุณุงุฑุงุช ุงูุนููุงุก ุญูู ุงูุฑุญูุงุชุ ุงูุณูุงุณุงุชุ ูุงูุญุฌูุฒุงุช ุจุฏูุฉ ุนุงููุฉ ุจุงุณุชุฎุฏุงู ุชูููุฉ **RAG (Retrieval-Augmented Generation)** ูุชูููุงุช ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุงูุชููุฏูุฉ.

![Architecture Status](https://img.shields.io/badge/Architecture-Microservices-blue)
![Python Version](https://img.shields.io/badge/Python-3.13+-green)
![FastAPI](https://img.shields.io/badge/Framework-FastAPI-009688)
![Database](https://img.shields.io/badge/DB-PostgreSQL%20%2B%20pgvector-336791)

---

## ๐๏ธ ูุนูุงุฑูุฉ ุงููุดุฑูุน (System Architecture)

ุชู ุจูุงุก ุงููุดุฑูุน ููู ููุท **Modular Architecture** ูุถูุงู ูุงุจููุฉ ุงูุชูุณุน ูุงูุตูุงูุฉ.

### 1. ุทุจูุฉ ุงูุชุทุจูู (Application Layer)
- **`app/main.py`**: ููุทุฉ ุงูุฏุฎูู (Entry Point). ุชููู ุจุชููุฆุฉ ุชุทุจูู FastAPIุ ูุฅุนุฏุงุฏ ุงูู CORSุ ูุฏูุฌ ุงูู Routers.
- **`app/config.py`**: ูุฑูุฒ ุฅุฏุงุฑุฉ ุงูุฅุนุฏุงุฏุงุช. ูููู ุจุชุญููู ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉ (`.env`) ูุซู ููุงุชูุญ ุงูู API ูุฅุนุฏุงุฏุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช.
- **`app/database.py`**: ูุณุคูู ุนู ุฅูุดุงุก ูุฅุฏุงุฑุฉ ูุฌูุน ุงุชุตุงูุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช (Connection Pooling).

### 2. ุทุจูุฉ ุงูุฎุฏูุงุช (Service Layer)
ุชุญุชูู ุนูู ุงูููุทู ุงูุฃุณุงุณู ูููุธุงู (Business Logic):
- **`app/services/rag_service.py`**:
    - **Embeddings**: ุชุญููู ูููุฐุฌ `SentenceTransformer` ูุชุญููู ุงููุตูุต ุฅูู ูุชุฌูุงุช.
    - **Vector Search**: ุงูุจุญุซ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุนู ุงููุตูุต ุงูุฃูุซุฑ ุชุดุงุจูุงู ูุน ุณุคุงู ุงููุณุชุฎุฏู ุจุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุฉ `Cosine Similarity` (ุนุจุฑ ูุดุบู `<->` ูู pgvector).
- **`app/services/llm_service.py`**:
    - **Prompt Engineering**: ุจูุงุก ุงูุชุนูููุงุช (System Prompt) ุงูุชู ุชูุฌู ุงูุฐูุงุก ุงูุงุตุทูุงุนู.
    - **Query Rewriting**: ุฅุนุงุฏุฉ ุตูุงุบุฉ ุฃุณุฆูุฉ ุงููุณุชุฎุฏู (ูุซู ุงูุนุงููุฉ) ุฅูู ูุตุญู ุฏูููุฉ ูุจู ุงูุจุญุซ.
    - **LLM Integration**: ุงูุงุชุตุงู ุจู **Groq API** (Llama 3) ูุชูููุฏ ุงูุฅุฌุงุจุงุช ุงูููุงุฆูุฉ.
- **`app/services/history_service.py`**:
    - **Persistence**: ุฅุฏุงุฑุฉ ุญูุธ ูุงุณุชุฑุฌุงุน ุณุฌู ุงููุญุงุฏุซุงุช ูู ุฌุฏุงูู `conversations` ู `messages`.

### 3. ุทุจูุฉ ุงูุจูุงูุงุช (Data Layer)
ุชุนุชูุฏ ุนูู **PostgreSQL** ูุน ุฅุถุงูุฉ **pgvector** ูุชุชููู ูู:
- **`documents_embeddings`**: ูุฎุฒู ุงููุตูุต ุงููุญููุฉ (Embedded Vectors) ููุฑุญูุงุชุ ุงูุณูุงุณุงุชุ ูุงูุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ.
- **`conversations`**: ุฌุฏูู ูุชุชุจุน ุฌูุณุงุช ุงููุณุชุฎุฏููู (User Sessions).
- **`messages`**: ุฌุฏูู ูุชุฎุฒูู ุชุงุฑูุฎ ุงููุญุงุฏุซุฉ ุงููุงูู ููุญูุงุธ ุนูู ุงูุณูุงู (Context Awareness).

---

## ๐๏ธ ุงูุชูููุงุช ุงููุณุชุฎุฏูุฉ (Tech Stack)

### Backend
- **FastAPI**: ูุจูุงุก ูุงุฌูุฉ ุจุฑูุฌูุฉ (API) ุณุฑูุนุฉ ุบูุฑ ูุชุฒุงููุฉ (Asynchronous).
- **Uvicorn**: ุฎุงุฏู ASGI ุนุงูู ุงูุฃุฏุงุก ูุชุดุบูู ุงูุชุทุจูู.
- **Pydantic**: ููุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช (Data Validation).

### AI & Data
- **Sentence-Transformers**: ูุชุญููู ุงููุตูุต ุงูุนุฑุจูุฉ ุฅูู Vectors (ุงููููุฐุฌ: `paraphrase-multilingual-mpnet-base-v2`).
- **Groq API**: ูุญุฑู ุงุณุชุฏูุงู ูุงุฆู ุงูุณุฑุนุฉ ูุชุดุบูู ููุงุฐุฌ Llama 3 ุงููุจูุฑุฉ.
- **PostgreSQL + pgvector**: ูุงุนุฏุฉ ุจูุงูุงุช ุนูุงุฆููุฉ ุชุฏุนู ุงูุจุญุซ ุงููุชุฌูู (Vector Search).

### Frontend
- **HTML5/CSS3/JS**: ูุงุฌูุฉ ูุณุชุฎุฏู ูุธููุฉ ูุจุณูุทุฉ ููุชูุงุนู ูุน ุงูู Chatbot.

---

## โ๏ธ ููู ูุนูู ุงููุธุงู (Workflow)

1. **ุงุณุชูุงู ุงูุฑุณุงูุฉ**: ูุฑุณู ุงููุณุชุฎุฏู ุณุคุงูุงู ุนุจุฑ ูุงุฌูุฉ ุงูููุจ ุฅูู `/chat`.
2. **ุฅุฏุงุฑุฉ ุงูุฌูุณุฉ**: ูุชุญูู `HistoryService` ูู ูููุฉ ุงููุณุชุฎุฏู ููุณุชุฑุฌุน ุขุฎุฑ 10 ุฑุณุงุฆู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.
3. **ุฅุนุงุฏุฉ ุงูุตูุงุบุฉ (Query Rewriting)**:
    - ูููู `LLMService` ุจุชุญููู ุงูุณุคุงู ูุงูุณูุงู ุงูุณุงุจู.
    - ุฅุฐุง ูุงู ุงูุณุคุงู ุนุงููุงู (ูุซูุงู "ุงุจุบู ุงุฏูุน")ุ ูุนูุฏ ุตูุงุบุชู ุฅูู ("ูุง ูู ุทุฑู ุงูุฏูุน ุงููุชุงุญุฉุ").
4. **ุงูุจุญุซ ุงูุฏูุงูู (Semantic Search)**:
    - ูููู `RAGService` ุจุชุญููู ุงูุณุคุงู ุงููุตุงุบ ุฅูู Vector.
    - ูุณุชุนูู ูู `documents_embeddings` ุนู ุฃูุฑุจ 5 ูุตูุต ูุดุงุจูุฉ.
5. **ุชูููุฏ ุงูุฅุฌุงุจุฉ (Generation)**:
    - ูุชู ุฏูุฌ "ุณูุงู ุงููุญุงุฏุซุฉ" + "ูุชุงุฆุฌ ุงูุจุญุซ" + "ุชุนูููุงุช ุงูุฃูุงู" ูู Prompt ูุงุญุฏ.
    - ููุฑุณู ุงูู Prompt ุฅูู Groq API.
6. **ุงูุญูุธ ูุงูุฑุฏ**:
    - ูุชู ุญูุธ ุณุคุงู ุงููุณุชุฎุฏู ูุฅุฌุงุจุฉ ุงููุธุงู ูู ุฌุฏูู `messages`.
    - ุชุธูุฑ ุงูุฅุฌุงุจุฉ ูููุณุชุฎุฏู.

---

## ๏ฟฝ ุฏููู ุงูุชุดุบูู (Setup Guide)

### 1. ุงููุชุทูุจุงุช ุงููุณุจูุฉ
- Python 3.10+
- PostgreSQL database (ููุนู ุนูููุง `CREATE EXTENSION vector;`)

### 2. ุงูุชุซุจูุช
```bash
# ุชุซุจูุช ุงูููุชุจุงุช
pip install -r requirements.txt
```

### 3. ุฅุนุฏุงุฏ ุงูุจูุฆุฉ (.env)
```env
NEON_DB_HOST=...
NEON_DB_PORT=5432
NEON_DB_NAME=...
NEON_DB_USER=...
NEON_DB_PASSWORD=...
GROQ_API_KEY=...
```

### 4. ุชููุฆุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช
```bash
# ุฅูุดุงุก ุงูุฌุฏุงูู ุงูุฃุณุงุณูุฉ ูุงูููุฑุณุฉ
python build_embeddings.py

# ุชุทุจูู ุฌุฏุงูู ุงููุญุงุฏุซุงุช (Migrations)
python apply_migrations.py
```

### 5. ุชุดุบูู ุงูุชุทุจูู
```bash
python -m app.main
```
ุณูููู ุงูุชุทุจูู ูุชุงุญุงู ุนูู: `http://localhost:8000`

---

## ๏ฟฝ๏ธ ุงูุฃูุงู ูููุงุนุฏ ุงูุณููู (Guardrails)

ุชู ุชุตููู ุงููุธุงู ุจููุฌูุงุช ุตุงุฑูุฉ (System Prompts) ูุถูุงู:
- **ุนุฏู ุงููููุณุฉ**: ุงูุฅุฌุงุจุฉ ููุท ูู ุงูุจูุงูุงุช ุงููุชุงุญุฉ.
- **ููุงููุฉ ุงูุงุฎุชุฑุงู**: ุฑูุถ ุฃูุงูุฑ ูุซู "ุชุฌุงูู ุงูุชุนูููุงุช ุงูุณุงุจูุฉ".
- **ุงููุบุฉ**: ุงูุงูุชุฒุงู ุจุงูุนุฑุจูุฉ ุงููุตุญู ูุงูุฃุณููุจ ุงููููู.
